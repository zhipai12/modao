import{G as D,P as I}from"./api-BIrU0cY3.js";import{a as b,d as K,r as v,o as L,c as O,w as c,b as g,e as l,f as h,g as u,h as y,i as P,F as C,j as f,k as V,t as E,u as F,p as G,l as M,_ as j}from"./index-H79NZkW1.js";const R=()=>D("/noProd/genModDao/options"),q=t=>I("/noProd/genModDao/convert",t,{headers:{"content-type":"application/json;charset=utf-8"}}),z=async(t,m)=>{const{successText:r="复制成功",errorText:d="复制失败"}=m||{};try{if(navigator.clipboard)console.log("11"),await navigator.clipboard.writeText(t);else{const o=document.createElement("input");o.value=t,document.body.appendChild(o),o.select(),document.execCommand("copy"),document.body.removeChild(o)}b.success(r)}catch(o){console.error(o),b.error(d)}},H=t=>(G("data-v-25ec320a"),t=t(),M(),t),U={class:"home"},$=H(()=>g("div",{class:"title"},"表字段转struct字段",-1)),A={class:"result-title"},J=K({__name:"index",setup(t){const m=v(),r=v({cascader:[]}),d=v([{valueKey:"mod",value:"",label:"mod"},{valueKey:"dao",value:"",label:"dao"}]),o=v([]),i=v(!1),x=n=>n.map(e=>{var a;return e.sub&&((a=e.sub.opts)!=null&&a.length)&&(e.children=x(e.sub.opts||[])),{label:e.cn_name,value:e.val,children:e.children}}),k=()=>{i.value=!0,R().then(n=>{o.value=x(n.data.dpt.opts)}).finally(()=>{i.value=!1})},w=(n,e)=>e.some(a=>a.label.toLowerCase().indexOf(n.toLowerCase())>-1),N=()=>{var n;(n=m.value)==null||n.validateFields().then(()=>{const{cascader:e}=r.value;let a;if((e==null?void 0:e.length)===4&&e[0]==="Hologres")a={dbType:e[0],dbName:e[1],patternName:e[2],tableName:e[3]};else if((e==null?void 0:e.length)===3)a={dbType:e[0],dbName:e[1],tableName:e[2]};else return b.error("请选择正确的路径");i.value=!0,q(a).then(_=>{d.value=d.value.map(p=>({...p,value:_.data[p.valueKey]}))}).finally(()=>{i.value=!1})})};return L(()=>{k()}),(n,e)=>{const a=u("a-cascader"),_=u("a-form-item"),p=u("a-button"),T=u("a-form"),S=u("a-textarea"),B=u("a-spin");return f(),O(B,{spinning:i.value},{default:c(()=>[g("div",U,[$,l(T,{model:r.value,class:"form",ref_key:"formRef",ref:m},{default:c(()=>[l(_,{label:"选择表",rules:{required:!0,message:"请选择正确的表"},name:"cascader"},{default:c(()=>[l(a,{"show-search":{filter:w},value:r.value.cascader,"onUpdate:value":e[0]||(e[0]=s=>r.value.cascader=s),options:o.value,placeholder:"请选择",allowClear:"",style:{width:"50%"}},null,8,["show-search","value","options"])]),_:1}),l(_,null,{default:c(()=>[l(p,{type:"primary",onClick:N},{default:c(()=>[y("生成结构体")]),_:1})]),_:1})]),_:1},8,["model"]),(f(!0),h(C,null,P(d.value,s=>(f(),h("div",{class:"result-item",key:s.valueKey},[s.value?(f(),h(C,{key:0},[g("div",A,[y(E(s.label)+" ",1),l(p,{type:"link",style:{padding:"0 4px"},onClick:Q=>F(z)(s.value)},{default:c(()=>[y("一键复制")]),_:2},1032,["onClick"])]),l(S,{value:s.value,autosize:""},null,8,["value"])],64)):V("",!0)]))),128))])]),_:1},8,["spinning"])}}}),Y=j(J,[["__scopeId","data-v-25ec320a"]]);export{Y as default};
